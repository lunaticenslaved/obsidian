**ФС** - способ хранения и организации доступа к файлам. Обычно имеет иерархическую систему, в которой каждый файл однозначно определяется путём к нему.

**Файл** - это отдельная область данных на одном из носителей информации, у которой есть собственное имя.

В основном пользователь имеет дело с тремя типами файлов:

- **файлами** - предназначенных для хранения файлов
- **каталогами** - это список ссылок на файлы
- **файлами-ссылками** - так Linux представляет внешне устройства (клавиатуры, мыши и т.д.). Это файлы особого типа, предназначенные для обращения к различным сетевым ресурсам и устройствам

**Текущая файловая система Linux - `Ext2/Ext3`.**

В файловой системе Linux нет папок и документов. Есть каталоги и файлы. На любой файл должна быть ссылка хотя бы из одного каталога.

Расширение файла - это только соглашение по именованию файлов с разным типов содержимого. Установленное расширение не гарантирует, что файл содержит данные именно этого типа. Определить тип содержимого можно на основании самих данных. Многие форматы в начале файла указывают, как следует интерпретировать дальнейшую информацию.

В Linux есть утилита `file`, которая предназначена для определения типа данных, содержащихся в файле. Эта утилита не доверяет расширение и всегда проверяет сами данные. Прежде чем открывать неизвестный файл, полезно проверить его тип, чтобы не передать в терминал управляющую последовательность.

В файловой системе Linux есть один и только один корневой каталог, который содержит все остальные данные. Он начинается с `/`. Положение любого файла в дереве каталогов точно описывается с помощью полного пути.

Чтобы подключать и отключать ФС (жёсткие или сетевые диски и т.д.) используются процедуры монтирования и размонтирования. После того как диск смонтирован, его данные включёны в общую ФС. Пользователь может даже не знать, что они хранятся на другом диске.

Стандарт `Filesystem Hierarchy Standard (FHS)` описывает, какие данные могут храниться в том или ином каталоге корневой директории и даже какие файлы и подкаталоги должны присутствовать в этих каталогах. Соблюдается во всех Linux-системах.

- `/bin` - содержит исполняемые файлы самых необходимых утилит. Командная оболочка знает, что искать коды утилит нужно именно здесь
- `/boot` - здесь находятся файлы, необходимые для самого первого этапа загрузки: загрузки ядра и само ядро
- `/dev` - содержит файлы-дырки. В действительности в этих файлах не хранятся никакие данные. Они с помощью этих файлов передаются
- `/etc` - хранит конфигурационные файлы системы
- `/home` - содержит домашние директории пользователей
- `/lib` - собрание стандартных функций, необходимых многим программам: операции ввода-вывода рисование графического интерфейса и т.д. Хранятся здесь, чтобы не включать эти же функции в каждую программу
- `/mnt` - каталог монтирования для ФС, расположенных на съёмных носителях
- `/proc` - содержит виртуальные файлы - файлы для тех процессов, что исполняются в данный момент
- `/root` - каталог рутового пользователя. Должен быть доступен всегда, тогда как `home` для него может отсутствовать
- `/sbin` - `system binaries`. Содержит важнейшие системные утилиты
- `/tmp` - временные файлы
- `/usr` - данные, необходимые для аварийной загрузки системы
- `/var` - содержат данные, необходимые для работы программ, как и `tmp`. Однако данные отсюда хранятся более длительное время

По принципу использования файлов выделяют следующие группы:

- **пользовательские/системные** - полезно разграничивать, т.к. пользовательские файлы можно выносить на отдельный носитель изменяющиеся/неизменные
- **неизменяемые** - это системные библиотеки и тд;
- **изменяемые** - это системные журналы, очереди печати и т.д. Вынесение изменяемых файлов в отдельную папку (`/usr`) позволяет использовать соответствующую часть ФС в формате “только чтение”, что снижает вероятность случайного повреждения данных.
- **разделяемые/неразделяемые** - разделяемые файлы - это те, что можно хранить на общем сервере и переиспользовать между компьютерами. Однако, часть файлов нельзя разделять между системами (например, файлы начальной загрузки системы).


## Директории

Пользователь всегда находится в какой-то директории. Команда `pwd` выводит в какой директории находится пользователь. Такая директория называется текущей.

С помощью команд `basename` и `dirname` можно узнать имя файла и путь к директории соответственно.

У любого пользователя есть домашний каталог. Путь к нему хранится в переменной окружения `HOME`.

Перемещение файла выполняется с помощью команды `mv`. Перемещение файла - это по сути переименование: файл остаётся в тех же секторах диска. Просто из предыдущего каталога удаляется ссылка на файл и добавляется ссылка на этот файл в новый каталог. В результате изменяется полное имя файла - полный путь.

Копирование выполняется с помощью команды `cp`


## Индексные дескрипторы

Вся информация, необходимая для работы с файлом, хранится в индексном дескрипторе. Для каждого файла есть один и только один индексный дескриптор, даже для файлов-дырок и каталогов.

Индексный дескриптор - это описание файла, в котором содержится:

- тип файла (файл, каталог и т.д.)
- права доступа к файлу
- информация о том, кому принадлежит файл
- отметки о времени создания, модификации, последнего доступа
- размер файла
- указатели на физические блоки на диске

Всё ИД пронумерованы уникальным числом. Узнать ИД файла можно при помощи `ls -i`.

Операции над файловой системой производятся на самом деле над индексными дескрипторами.


## Жёсткие ссылки

Каждый файл представляет собой область памяти на диске, которую можно найти по полному имени. В файловой системе Linux каждый файл связывается с его именем при помощи жёстких ссылок.

Создание любого файла означает, что будет создана жёсткая ссылка. Причем, количество ссылок на одну и ту же область неограниченно.

Создать жёсткую ссылку можно при помощи команды `ln`.

В команде `ls` выводится количество жёстких ссылок на файл.

У жёстких ссылок есть два ограничения:

- из нельзя создавать для каталогов, т.к. могут возникнуть циклы
- жёсткая ссылка не может указывать на файл, расположенный в другой файловой системе (например, на диске)

Жёсткие ссылки связывают полное имя файла с **индексным дескриптором**.


## Символьные ссылки

Символьные ссылки были созданы, чтобы обойти ограничения жестких ссылок.

`Символьная ссылка` - это просто файл, в котором записано имя другого файла. Это файлы особого типа `“l”`. Символьная ссылка создается с помощью команды `ln -s`.

Символьная ссылка может содержать имя несуществующего файла, но она будет нерабочей.

Узнать, куда указывает символьная ссылка можно с помощью утилиты `realpath`.


## Удаление файлов и каталогов

Удаление файлов выполняется с помощью утилиты `rm`. Удаление каталогов производится с помощью утилиты `rmdir`.

На самом деле удаляется жёсткая ссылка на файл. Если это была единственная ссылка, то файл удалится сборщиком, так как ссылок на него больше не будет. Наличие символьных ссылок не являются препятствием для физического удаления файла.


## Ярлыки объектов файловой системы

// TODO узнать подробнее

При создании объектов ФС каждому в обязательном порядке присваивается ярлык.

Ярлык включает в себя `UID` идентификатор пользователя-хозяина файла, `GID` - идентификатор группы, которой принадлежит файл, тип объекта и набор атрибутов. Атрибуты определяют, кто и что с файлом может делать.